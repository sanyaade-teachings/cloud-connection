<?xml version="1.0" encoding="UTF-8"?>
    <!--
        Import per project custom build rules if present at the root of the project.
        This is the place to put custom intermediary targets such as:
            -pre-build
            -pre-compile
            -post-compile (This is typically used for code obfuscation.
                           Compiled code location: ${out.classes.absolute.dir}
                           If this is not done in place, override ${out.dex.input.absolute.dir})
            -post-package
            -post-build
            -pre-clean
    -->
<project>    
  
  <!-- adding ant contrib to the tasks -->
  <taskdef resource="net/sf/antcontrib/antcontrib.properties">
    <classpath>
      <pathelement location="ant/antcontrib/ant-contrib-0.6.jar"/>
    </classpath>
  </taskdef>
  
  <!-- adding the Vision ANT Tasks task definitions -->
  <taskdef resource="com/havok/Vision/anttasks/visionanttasks.properties">
    <classpath>
      <pathelement location="ant/VisionAntTasks/VisionAntTasks.jar"/>
    </classpath>
  </taskdef>  
  
	<target name="-pre-build">
	   <echo>**** -pre-build *****</echo>
     
     <fail unless="${arch}">The arch value has not been set!</fail>
     <fail unless="${mainlib}">The mainlib value has not been set!</fail>
     <fail unless="${extranativelib}">The extranativelib value has not been set!</fail>
     
     <echo>arch= ${arch}</echo> <!-- should be armeabi-v7a -->
     <echo>mainlib= ${mainlib}</echo>
     <echo>extranativelib= ${extranativelib}</echo>
     
    <!-- copy the native binaries that were built in visual studio into the /libs folder -->     
    <!-- copy the lib to correct folder (arm or x86) -->
    <copy file="${mainlib}" todir="./libs/${arch}"/>
    
    <!-- strip the symbols from the main lib to shrink it -->   
    <VisionStripLib Arch="${arch}" Lib="${mainlib}"/>
    
    <!-- TODO: rename lib with "lib" prefix -->
    
    <!-- copy any other .so libs required to run the game (such as fmod libs) --> 
    <foreach target="copyNativeLib" param="nativelibtocopy" list="${extranativelib}" delimiter="*"/>
                
    <!-- copy the main assets -->
    <VisionCopyAssets DestinationPath="./assets">
      <fileset dir="../../../../Assets/">
        <include name="**"/>
        <exclude name="**/AssetMgmt_data/thumbnails/*"/>
      </fileset>
    </VisionCopyAssets>
    
    <!-- copy the vision base assets /Data folder -->
    <VisionCopyAssets DestinationPath="./assets">
      <fileset dir="../../../../Data/">
        <include name="**"/>
        <exclude name="**/AssetMgmt_data/thumbnails/*"/>
      </fileset>
    </VisionCopyAssets>
        
	</target>
  
  <!-- copy the file ${nativelibtocopy} to the libs folder  -->
  <target name="copyNativeLib">
    <copy file="${nativelibtocopy}" todir="./libs/${arch}"/>
  </target>
  
	<target name="-pre-compile">
	    <echo>**** -pre-compile *****</echo>
	</target>
	
	<target name="-post-compile">
	    <echo>**** -post-compile *****</echo>
	</target>    
	
	<target name="-post-package">
	    <echo>**** post-package *****</echo>
	</target> 
	
	<target name="-post-build">
	    <echo>**** -post-build *****</echo>
	</target> 
	
	<target name="-pre-clean">
	    <echo>**** -pre-clean *****</echo>
	</target>
</project>